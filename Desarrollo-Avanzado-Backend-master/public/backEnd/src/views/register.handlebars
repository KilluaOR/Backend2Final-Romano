<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <h1 class="mb-4">Registro</h1>
      <form id="register-form" class="mb-4">
        <input class="form-control mb-2" type="text" id="first_name" name="first_name" placeholder="Nombre" required />
        <input class="form-control mb-2" type="text" id="last_name" name="last_name" placeholder="Apellido" required />
        <input class="form-control mb-2" type="email" id="email" name="email" placeholder="Email" required />
        <input class="form-control mb-2" type="number" id="age" name="age" min="0" placeholder="Edad" required />
        <input class="form-control mb-2" type="password" id="password" name="password" placeholder="Contraseña" required />
        <button class="btn btn-primary w-100" type="submit">Registrarme</button>
      </form>
      <p class="text-center">¿Ya tenés cuenta? <a href="/login">Iniciar sesión</a></p>
    </div>
  </div>
</div>

<script>
  const registerForm = document.getElementById('register-form');

  registerForm.addEventListener('submit', async (event) => {
    event.preventDefault();

    const body = {
      first_name: registerForm.first_name.value,
      last_name: registerForm.last_name.value,
      email: registerForm.email.value,
      age: parseInt(registerForm.age.value, 10),
      password: registerForm.password.value,
    };

    try {
      const response = await fetch('/api/sessions/register', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(body),
      });

      const data = await response.json();

      if (!response.ok || data.status === 'error') {
        alert(data.message || 'Error al registrarse');
        return;
      }

      alert('Usuario registrado correctamente. Ahora podés iniciar sesión.');
      window.location.href = '/login';
    } catch (error) {
      console.error(error);
      alert('Error inesperado al registrarse');
    }
  });
</script>

